<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">

	<title>Cohort Web Test</title>

	<meta name="description" content="">

  <!-- Mobile-friendly viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script type="text/javascript">

	var audio = document.createElement('audio');
	audio.src = 'media/flux-web-v2.mp3';

	var load = function(){
		audio.play();
		audio.pause();
		console.log("audio loaded")
	}

		source = new EventSource("/listen");

		source.addEventListener('open', function(e) {
  			console.log("opened sse connection");
		}, false);

		source.addEventListener('error', function(e) {
  			if (e.readyState == EventSource.CLOSED) {
    			console.log("closed sse connection");
  			}
		}, false);

		source.addEventListener('message', function(e) {

			console.log("received sse");
			console.log(data);
  			// var data = JSON.parse(e.data);
  			// console.log(data.id, data.msg);
		}, false);

		source.addEventListener('cohortMessage', function(e) {
			audio.play();
			console.log("received sse");
			console.log(e);
  			// var data = JSON.parse(e.data);
  			// console.log(data.id, data.msg);
		}, false);

	</script>

</head>
<body>
	<main role="main">
		<h1>Cohort Web Test</h1>
		<!-- <button id = "b1" onclick="load()"> GO! </button> -->
    </main>
</body>
</html>
